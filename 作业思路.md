# 第三次作业总结

作业地址：https://www.kaggle.com/c/ml2021spring-hw3/

作业介绍：https://speech.ee.ntu.edu.tw/~hylee/ml/ml2021-course-data/hw/HW03/HW03.pdf（不保证不会失效）

参考代码：https://colab.research.google.com/github/ga642381/ML2021-Spring/blob/main/HW03/HW03.ipynb

## 简要说明

- 预测食物图片分类问题
- 目标：
  - 使用CNN
  - 数据增强
  - 处理无标签数据
- food-11数据集（11个类）
  - 训练集： 280 * 11 labeled images + 6786 unlabeled images
  - 验证集： 30 * 11 labeled images
  - 测试集：3347 images
- 要求：不能使用预训练模型（resnet等）
- baseline评判标准：准确度百分比

- 提示：

  - 半监督学习：为无标签数据生成伪标签（pseudo-labels）

    ![image-20210326154911569](https://yumytest.oss-cn-chengdu.aliyuncs.com/img/image-20210326154911569.png)




## 实作

### 改进点1——图像增强



```python
train_tfm = transforms.Compose([
    # Resize the image into a fixed shape (height = width = 128)
    transforms.Resize((128, 128)),
    # You may add some transforms here.
#     transforms.Normalize((0.485, 0.456, 0.406), (0.229, 0.224, 0.225)),
    transforms.RandomVerticalFlip(0.3),     # 以概率垂直翻转
    transforms.RandomHorizontalFlip(0.3),
    # ToTensor() should be the last one of the transforms.
    transforms.ToTensor(),
])
```

### 改进点2——模型结构

```python
class Classifier(nn.Module):
    def __init__(self):
        super(Classifier, self).__init__()
        # The arguments for commonly used modules:
        # torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)
        # torch.nn.MaxPool2d(kernel_size, stride, padding)

        # input image size: [3, 128, 128]
        self.cnn_layers = nn.Sequential(
            nn.Conv2d(3, 64, 3, 1, 1),
            nn.BatchNorm2d(64),
            nn.ReLU(),
            nn.MaxPool2d(2, 2, 0),

            nn.Conv2d(64, 128, 3, 1, 1),
            nn.BatchNorm2d(128),
            nn.ReLU(),
            nn.MaxPool2d(2, 2, 0),

            nn.Conv2d(128, 256, 3, 1, 1),
            nn.BatchNorm2d(256),
            nn.ReLU(),
            nn.MaxPool2d(4, 4, 0),
        )
        self.fc_layers = nn.Sequential(
            nn.Linear(256 * 8 * 8, 256),
            nn.ReLU(),
            nn.Linear(256, 64),
            nn.ReLU(),
            nn.Linear(64, 11)
        )
        
```

或者直接使用已有模型：

```python
model = torchvision.models.resnet18(pretrained=False).to(device)
```



### 改进点3——半监督学习

```python

```







## 问题

- [x] 为什么给无监督学习标记在训练模型之前

  